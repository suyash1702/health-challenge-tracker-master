<!-- app.component.html -->
<div class="container mx-auto p-4">
  <h1 class="text-2xl font-bold mb-4">Health Challenge Tracker App</h1>
  <form #workoutForm="ngForm" (ngSubmit)="onSubmit(workoutForm)" class="space-y-4">
    <div class="form-group">
      <label for="userName" class="block text-gray-700">User Name*</label>
      <input type="text" id="userName" name="userName" [(ngModel)]="userName" required class="w-full p-2 border border-gray-300 rounded-md">
    </div>
    <div class="flex gap-4">
      <div class="form-group flex-1">
        <label for="workoutType" class="block text-gray-700">Workout Type*</label>
        <select id="workoutType" name="workoutType" [(ngModel)]="workoutType" required class="w-full p-2 border border-gray-300 rounded-md">
          <option value="">Select a workout type</option>
          <option *ngFor="let type of availableWorkoutTypes" [value]="type">{{type}}</option>
        </select>
      </div>
      <div class="form-group flex-1">
        <label for="workoutMinutes" class="block text-gray-700">Workout Minutes*</label>
        <input type="number" id="workoutMinutes" name="workoutMinutes" [(ngModel)]="workoutMinutes" required class="w-full p-2 border border-gray-300 rounded-md">
      </div>
    </div>
    <button type="submit" [disabled]="!workoutForm.form.valid" class="px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 disabled:bg-gray-300">Add Workout</button>
  </form>

  <div class="workout-list mt-8">
    <h2 class="text-xl font-semibold">Workout Entries</h2>
    <div class="filters flex gap-4 mb-4">
      <input type="text" placeholder="Search by name" [(ngModel)]="searchTerm" (ngModelChange)="applyFilters()" class="p-2 border border-gray-300 rounded-md">
      <select [(ngModel)]="filterType" (ngModelChange)="applyFilters()" class="p-2 border border-gray-300 rounded-md">
        <option value="">All Workout Types</option>
        <option *ngFor="let type of availableWorkoutTypes" [value]="type">{{type}}</option>
      </select>
    </div>
    <table class="w-full border-collapse mb-4">
      <thead>
        <tr class="bg-gray-200">
          <th class="border p-2">Name</th>
          <th class="border p-2">Workouts</th>
          <th class="border p-2">Number of Workouts</th>
          <th class="border p-2">Total Workout Minutes</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let entry of paginatedEntries">
          <td class="border p-2">{{entry.userName}}</td>
          <td class="border p-2">{{entry.workoutType}}</td>
          <td class="border p-2">{{getNumberOfWorkouts(entry.userName)}}</td>
          <td class="border p-2">{{getTotalWorkoutMinutes(entry.userName)}}</td>
        </tr>
      </tbody>
    </table>
    <div class="pagination flex justify-between items-center mt-4">
      <button (click)="changePage(-1)" [disabled]="currentPage === 1" class="px-3 py-1 bg-gray-200 rounded-md hover:bg-gray-300">←</button>
      <span>Page {{currentPage}} of {{totalPages}}</span>
      <button (click)="changePage(1)" [disabled]="currentPage === totalPages" class="px-3 py-1 bg-gray-200 rounded-md hover:bg-gray-300">→</button>
      <select [(ngModel)]="itemsPerPage" (ngModelChange)="applyFilters()" class="p-2 border border-gray-300 rounded-md">
        <option [value]="5">5 per page</option>
        <option [value]="10">10 per page</option>
        <option [value]="20">20 per page</option>
      </select>
    </div>
  </div>

  <div class="workout-progress flex mt-8">
    <div class="user-list w-1/4 mr-4">
      <h2 class="text-xl font-semibold">Users</h2>
      <ul class="list-none p-0">
        <li *ngFor="let user of getUniqueUsers()" (click)="selectUser(user)" [class.bg-gray-200]="user === selectedUser" class="p-2 cursor-pointer border-b border-gray-300">{{user}}</li>
      </ul>
    </div>
    <div class="chart-container flex-grow">
      <h2 class="text-xl font-semibold" *ngIf="selectedUser">{{selectedUser}}'s workout progress</h2>
      <canvas id="chartCanvas" class="w-full h-72"></canvas>
    </div>
  </div>
</div>
